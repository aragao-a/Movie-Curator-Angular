<div class="movie-list-container">
  <div class="search-bar">
    <input
      class="search-input"
      [formControl]="searchControl"
      placeholder="Buscar por nome do filme..."
    />
  </div>

  @if(facade.isLoading$ | async) {
    <div class="loading-spinner">Buscando durações, por favor aguarde...</div>
  }

  <ng-container *ngIf="searchResults$ | async as searchResults">
    @if (searchResults.length > 0) {
      <h2>Resultados da Busca:</h2>
      <div class="movie-grid">
        <app-movie-card 
        *ngFor="let movie of searchResults" 
        [movie]="movie"
        (addMovie)="handleAddMovie($event)"
      >
      </app-movie-card>
      </div>
    } @else {
      <app-carousel
        [title]="'Filmes Populares'"
        [items]="(facade.popularMovies$ | async)!"
        [genres]="(genres$ | async)!"
        (addMovie)="handleAddMovie($event)" 
        (sortByRuntimeRequested)="handleSortByRuntime('popularMovies')"
      ></app-carousel>
      
      <app-carousel
        [title]="'Mais Votados'"
        [items]="(facade.topRatedMovies$ | async)!"
        [genres]="(genres$ | async)!"
        (addMovie)="handleAddMovie($event)" 
        (sortByRuntimeRequested)="handleSortByRuntime('topRatedMovies')"
      ></app-carousel>

      <app-carousel
        [title]="'Em Breve'"
        [items]="(facade.upcomingMovies$ | async)!"
        [genres]="(genres$ | async)!"
        (addMovie)="handleAddMovie($event)" 
        (sortByRuntimeRequested)="handleSortByRuntime('upcomingMovies')"
      ></app-carousel>
    }
  </ng-container>
</div>